import{d as z,k as $,r as b,J as U,o as J,K as W,x as w,y as g,L as H,z as e,M as E,_ as K,A as R,N as X,O as Y,P as G,B as T,T as Z,C as ee,Q as te,R as L}from"./CPPYWF3V.js";import{_ as V}from"./DlAUqK2U.js";const ne={key:0,class:"loading-overlay"},se=z({__name:"VisualLayer",props:{sentimentScore:{}},setup(v){const c=v,i=$(()=>{const t=c.sentimentScore??0;return t<=-.5?"sentiment-negative":t<=0?"sentiment-neutral-negative":t<=.5?"sentiment-neutral-positive":"sentiment-positive"}),n=b(null),u=b(!1);let m,l,o,a,f={x:0,y:0},_=null,h=null,p=null;const y=async()=>(h||(h=await K(()=>import("./Dzg8QwEX.js"),[],import.meta.url),p=h),h),S=async()=>{if(!n.value)return;const t=await y();m=new t.Scene,l=new t.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),l.position.z=50,o=new t.WebGLRenderer({antialias:!0,alpha:!0,powerPreference:"high-performance"}),o.setSize(window.innerWidth,window.innerHeight),o.setPixelRatio(Math.min(window.devicePixelRatio,2)),n.value.appendChild(o.domElement),I(t),u.value=!0,B()},I=t=>{const r=window.innerWidth<768?1e3:2e3,s=new t.BufferGeometry,d=new Float32Array(r*3),A=new Float32Array(r*3);for(let k=0;k<r;k++){d[k*3]=(Math.random()-.5)*100,d[k*3+1]=(Math.random()-.5)*100,d[k*3+2]=(Math.random()-.5)*100;let x;const P=c.sentimentScore??0;P<=-.5?x=new t.Color(4937059):P<=0?x=new t.Color(3900150):P<=.5?x=new t.Color(6333946):x=new t.Color(16498468),A[k*3]=x.r,A[k*3+1]=x.g,A[k*3+2]=x.b}s.setAttribute("position",new t.BufferAttribute(d,3)),s.setAttribute("color",new t.BufferAttribute(A,3));const C=new t.PointsMaterial({size:.5,vertexColors:!0,transparent:!0,opacity:.8,sizeAttenuation:!0});a=new t.Points(s,C),m.add(a)},B=()=>{if(!a||!o||!m||!l){_=null;return}a.rotation.x+=5e-4,a.rotation.y+=5e-4;const t=a.geometry.attributes.position.array,r=Math.abs(c.sentimentScore??0)*.1;for(let s=0;s<t.length;s+=3){const d=Date.now()*.001;t[s]+=Math.sin(d+s*.1)*r,t[s+1]+=Math.cos(d+s*.1)*r,t[s]+=(Math.random()-.5)*.05,t[s+1]+=(Math.random()-.5)*.05,t[s]=Math.max(-50,Math.min(50,t[s])),t[s+1]=Math.max(-50,Math.min(50,t[s+1]))}a.geometry.attributes.position.needsUpdate=!0,o.render(m,l),_=requestAnimationFrame(B)};let M=null;const D=t=>{M||(M=window.setTimeout(()=>{const r=c.sentimentScore??0,s=n.value?.getBoundingClientRect();if(!s)return;const d=(t.clientX-s.left)/s.width*2-1,A=-((t.clientY-s.top)/s.height)*2+1;if(f.x=d*(1+r*.5),f.y=A*(1+r*.5),a){const C=a.geometry.attributes.position.array,k=.1;for(let x=0;x<C.length;x+=3){const P=C[x]-f.x*50,N=C[x+1]-f.y*50,q=Math.sqrt(P*P+N*N);if(q<20){const O=(1-q/20)*k;C[x]+=P*O,C[x+1]+=N*O}}a.geometry.attributes.position.needsUpdate=!0}M=null},16))};U(()=>c.sentimentScore,async()=>{if(!a||!h||(p||await y(),!p||!a))return;const t=a.geometry.attributes.color.array,r=c.sentimentScore??0;for(let s=0;s<t.length;s+=3){let d;r<=-.5?d=new p.Color(4937059):r<=0?d=new p.Color(3900150):r<=.5?d=new p.Color(6333946):d=new p.Color(16498468),t[s]=d.r,t[s+1]=d.g,t[s+2]=d.b}a.geometry.attributes.color.needsUpdate=!0});let F=null;const j=()=>{F||(F=window.setTimeout(()=>{!n.value||!l||!o||(l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight),o.setPixelRatio(Math.min(window.devicePixelRatio,2)),F=null)},250))};return J(()=>{S(),window.addEventListener("mousemove",D,{passive:!0}),window.addEventListener("resize",j,{passive:!0})}),W(()=>{window.removeEventListener("mousemove",D),window.removeEventListener("resize",j),_&&cancelAnimationFrame(_),M&&clearTimeout(M),F&&clearTimeout(F),o&&o.dispose(),a&&(a.geometry.dispose(),a.material.dispose())}),(t,r)=>(g(),w("div",{class:H(["visual-layer",i.value])},[e("div",{ref_key:"container",ref:n,class:"w-full h-full"},null,512),u.value?E("",!0):(g(),w("div",ne,[...r[0]||(r[0]=[e("div",{class:"loading-spinner"},null,-1)])]))],2))}}),oe=V(se,[["__scopeId","data-v-8bab773e"]]),Q=globalThis.setInterval,ae={class:"sound-controls"},ie=["title"],re={class:"sound-icon"},le={key:0,class:"loading-spinner"},ce={key:1},ue={key:2},de={key:0,class:"volume-control"},me=z({__name:"AmbientSound",props:{sentimentScore:{}},setup(v){const c=v,i=b(!1),n=b(!1),u=b(!0),m=b(.5),l=b("#4F46E5");let o=null,a=null,f=null,_=null,h=null;const p=$(()=>n.value?"Initialiserer lyd...":u.value?"Klik for at aktivere lyd":i.value?"Sluk lyd":"TÃ¦nd lyd"),y=async()=>(_||(_=await K(()=>import("./CRRRl7Lg.js"),[],import.meta.url)),_),S=["C3","D3","Eb3","F3","G3","Ab3","Bb3","C4"],I=["C3","D3","E3","F3","G3","A3","B3","C4"],B=async()=>{try{const t=await y();await t.start(),o=new t.PolySynth(t.Synth,{oscillator:{type:"sine"},envelope:{attack:2,decay:1,sustain:.5,release:4}}).toDestination(),a=new t.Reverb({decay:8,wet:.8,preDelay:.2}).toDestination();const r=new t.FeedbackDelay({delayTime:"4n",feedback:.4,wet:.3}).toDestination();o.chain(a,r,t.Destination),f=new t.Filter({type:"lowpass",frequency:1e3,rolloff:-24,Q:1}).toDestination(),o.connect(f),console.log("Lydsystem initialiseret")}catch(t){console.error("Fejl ved initialisering af lydsystem:",t),u.value=!0}},M=async()=>{if(!(!o||!i.value||!_))try{const t=await y(),r=c.sentimentScore??0;let s,d=S;r<=-.5?s=["C3","Eb3","G3"]:r<=0?s=["Eb3","G3","Bb3"]:r<=.5?(s=["F3","A3","C4"],d=I):(s=["C3","E3","G3"],d=I),o.triggerAttackRelease(s,"8n");const A=d[Math.floor(Math.random()*d.length)];if(o.triggerAttackRelease(A,"2n",t.now()+.5),f){const C=Math.max(20,Math.min(2e4,1e3+r*1e3));f.frequency.rampTo(C,.5)}}catch(t){console.error("Fejl ved afspilning af akkord:",t)}},D=async()=>{if(!(!i.value||!_))try{const t=await y();await M(),h=Q(async()=>{i.value&&await M()},4e3)}catch(t){console.error("Fejl ved afspilning af ambient lyd:",t),i.value=!1,u.value=!0}},F=async()=>{if(i.value)console.log("Slukker lyd..."),i.value=!1,h&&(clearInterval(h),h=null),o&&(o.dispose(),o=null),a&&(a.dispose(),a=null),f&&(f.dispose(),f=null);else try{console.log("Starter lydinitialisering..."),n.value=!0,console.log("Venter pÃ¥ Tone.start()..."),await B(),console.log("Lydsystem initialiseret"),u.value=!1,i.value=!0,await D()}catch(t){console.error("Fejl ved start af lyd:",t),u.value=!0}finally{n.value=!1}},j=()=>{o&&(o.volume.value=(m.value-1)*20)};return U(()=>c.sentimentScore,()=>{const t=c.sentimentScore??0;t<=-.5?l.value="#6B7280":t<=0?l.value="#3B82F6":t<=.5?l.value="#60A5FA":l.value="#FBBF24"}),W(()=>{h&&clearInterval(h),o&&o.dispose(),a&&a.dispose(),f&&f.dispose()}),(t,r)=>(g(),w("div",ae,[e("button",{onClick:F,class:H(["sound-button",{"is-playing":i.value,"is-loading":n.value,"needs-interaction":u.value}]),title:p.value},[e("span",re,[n.value?(g(),w("span",le)):u.value?(g(),w("span",ce,"ðŸ‘†")):(g(),w("span",ue,R(i.value?"ðŸ”Š":"ðŸ”‡"),1))])],10,ie),i.value?(g(),w("div",de,[X(e("input",{type:"range","onUpdate:modelValue":r[0]||(r[0]=s=>m.value=s),min:"0",max:"1",step:"0.01",class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",style:G([{background:`linear-gradient(to right, ${l.value} 0%, ${l.value} ${m.value*100}%, #e5e7eb ${m.value*100}%, #e5e7eb 100%)`},{appearance:"none","-webkit-appearance":"none"}]),onInput:j},null,36),[[Y,m.value]])])):E("",!0)]))}}),fe=V(me,[["__scopeId","data-v-b583053e"]]),pe={class:"sentiment-meter"},ve={class:"meter-container"},we={class:"meter-track"},ge={key:0,class:"loading-indicator"},he={key:1,class:"error-indicator"},ye={key:2},xe=z({__name:"SentimentMeter",props:{score:{},isLoading:{type:Boolean},error:{}},emits:["retry"],setup(v,{emit:c}){const i=v,n=$(()=>typeof i.score!="number"?"0.00":i.score.toFixed(2)),u=$(()=>typeof i.score!="number"?0:i.score),m=$(()=>typeof i.score!="number"||i.score<0?"#ff4444":i.score>0?"#00C851":"#ffbb33"),l=$(()=>typeof i.score!="number"?"0.00":n.value);return(o,a)=>(g(),w("div",pe,[e("div",ve,[e("div",we,[e("div",{class:"meter-fill",style:G({width:`${(u.value+1)*50}%`,backgroundColor:m.value})},null,4)]),a[1]||(a[1]=e("div",{class:"meter-labels"},[e("span",{class:"label negative"},"Negativ"),e("span",{class:"label neutral"},"Neutral"),e("span",{class:"label positive"},"Positiv")],-1))]),e("div",{class:"score-display",style:G({color:m.value})},[v.isLoading?(g(),w("span",ge,"Loading...")):v.error?(g(),w("span",he,R(v.error),1)):(g(),w("span",ye,R(l.value),1))],4),v.error?(g(),w("button",{key:0,onClick:a[0]||(a[0]=f=>o.$emit("retry")),class:"retry-button"}," PrÃ¸v igen ")):E("",!0)]))}}),be=V(xe,[["__scopeId","data-v-3f2fca36"]]),_e={class:"flex justify-between items-start p-8 pb-6"},ke=z({__name:"InfoDialog",setup(v){const c=b(!1);return(i,n)=>(g(),w("div",null,[e("button",{onClick:n[0]||(n[0]=u=>c.value=!0),class:"fixed top-8 right-8 p-4 rounded-full bg-white/10 transition-all duration-300 backdrop-blur-md shadow-xl z-50","aria-label":"Show information"},[...n[4]||(n[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-white",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)])]),T(Z,{"enter-active-class":"transition duration-500 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-300 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:ee(()=>[c.value?(g(),w("div",{key:0,class:"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center p-8 z-50",onClick:n[3]||(n[3]=u=>c.value=!1)},[e("div",{class:"bg-white/5 backdrop-blur-2xl rounded-2xl shadow-2xl max-w-4xl w-full max-h-[85vh] overflow-hidden p-8",onClick:n[2]||(n[2]=te(()=>{},["stop"]))},[e("div",_e,[n[6]||(n[6]=e("div",{class:"space-y-3"},[e("h2",{class:"text-4xl font-light text-white tracking-tight"}," About EmotionWave "),e("p",{class:"text-white/60 text-lg font-light"}," A living artwork that reflects the world's mood ")],-1)),e("button",{onClick:n[1]||(n[1]=u=>c.value=!1),class:"text-white/40 transition-colors p-2 rounded-full","aria-label":"Close dialog"},[...n[5]||(n[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),n[7]||(n[7]=e("div",{class:"p-8 space-y-8 overflow-y-auto max-h-[60vh]"},[e("div",{class:"space-y-4"},[e("p",{class:"text-white/80 text-lg leading-relaxed font-light"}," EmotionWave is an interactive artwork that visualizes the world's mood in real-time. Through sentiment analysis of news articles from various sources, the installation creates a dynamic visual and audio experience that reflects the current global sentiment. ")]),e("div",{class:"space-y-6"},[e("h3",{class:"text-2xl font-light text-white flex items-center gap-3"}," How it works "),e("div",{class:"grid gap-4"},[e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"News articles are analyzed every 30 seconds using AI")]),e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"Sentiment score ranges from -1 (negative) to +1 (positive)")]),e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"Visual elements and ambient music adapt to the sentiment")]),e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"Interactive particles respond to your mouse movements")])])]),e("div",{class:"space-y-6"},[e("h3",{class:"text-2xl font-light text-white flex items-center gap-3"}," Visual elements "),e("div",{class:"grid gap-4"},[e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"Particle system that changes color and movement based on sentiment")]),e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"Sentiment meter showing the current global mood")]),e("div",{class:"flex items-start gap-4 p-6 rounded-xl"},[e("p",{class:"text-white/70 text-base"},"Ambient music that shifts between minor and major scales")])])]),e("div",{class:"space-y-6"},[e("h3",{class:"text-2xl font-light text-white flex items-center gap-3"}," News sources "),e("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-4"},[e("div",{class:"p-6 rounded-xl"},[e("p",{class:"text-white/80 font-medium text-base"},"GDELT API"),e("p",{class:"text-white/50 text-sm"},"Global news sentiment data")]),e("div",{class:"p-6 rounded-xl"},[e("p",{class:"text-white/80 font-medium text-base"},"HuggingFace"),e("p",{class:"text-white/50 text-sm"},"AI sentiment analysis")])])])],-1)),n[8]||(n[8]=e("div",{class:"p-8 pt-6 bg-white/5"},[e("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 text-sm text-white/50"},[e("div",{class:"flex items-center gap-6"},[e("span",{class:"flex items-center gap-2"}," Nuxt 3 "),e("span",{class:"flex items-center gap-2"}," Three.js "),e("span",{class:"flex items-center gap-2"}," Tone.js ")]),e("p",{class:"text-white/30"},"Sentiment analysis powered by HuggingFace")])],-1))])])):E("",!0)]),_:1})]))}}),Se=V(ke,[["__scopeId","data-v-c9ea3536"]]);function Ce(){const v=b(0),c=b(0),i=b({positive:0,negative:0,neutral:0}),n=b(!1),u=b(null),m=b({});let l=null,o=null;const a=()=>{const p=v.value,y=c.value,S=y-p;if(Math.abs(S)<.001){v.value=y,o=null;return}v.value+=S*.1,o=requestAnimationFrame(a)};async function f(){n.value=!0,u.value=null;try{const p=await fetch("/api/advanced-sentiment");if(!p.ok)throw new Error("Failed to fetch sentiment data");const y=await p.json();console.log("Fetched sentiment data:",y),c.value=y.score,y.sources&&(m.value=y.sources.reduce((S,I)=>(S[I.name]=I.score,S),{})),o||a()}catch(p){u.value=p instanceof Error?p.message:"An error occurred",console.error("Error fetching sentiment:",p)}finally{n.value=!1}}function _(){l&&clearInterval(l),l=Q(f,3e4)}function h(){l&&(clearInterval(l),l=null),o&&(cancelAnimationFrame(o),o=null)}return{sentimentScore:v,sentimentDetails:i,isLoading:n,error:u,sources:m,fetchSentiment:f,startPolling:_,stopPolling:h}}const Me={class:"min-h-screen bg-black text-white"},Fe=z({__name:"index",setup(v){const{sentimentScore:c,isLoading:i,error:n,fetchSentiment:u,startPolling:m,stopPolling:l}=Ce();return J(()=>{u(),m()}),W(()=>{l()}),(o,a)=>(g(),w("div",Me,[T(oe,{"sentiment-score":L(c)},null,8,["sentiment-score"]),T(fe,{"sentiment-score":L(c)},null,8,["sentiment-score"]),T(be,{score:L(c),"is-loading":L(i),error:L(n),onRetry:L(u)},null,8,["score","is-loading","error","onRetry"]),T(Se)]))}});export{Fe as default};
